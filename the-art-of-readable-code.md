## 1. 代码应当易于理解
===================================================

### **本节关键思想**
* 代码应当易于理解（可读性基本定理）。
* 代码的写法应当使别人理解它所需要的时间最小化。该含义很直接：即如果叫一个普通同事过来，测算一下他通读你代码并理解它所需要的时间，这个“理解代码时间”就是你要最小化的理论度量。
* 当代码的可读性与其他目标有冲突时（例如更好的架构，更有效率或者更容易测试），请记住，可读性基本定理总是优于本书中的任何其他条例或原则。

## 2. 把信息装进名字里
===================================================

### **本节关键思想**
本章节的唯一主题即：把信息塞入到变量的名字里。这句话的含义是，读者仅仅通过读到变量的名字，就可以获得大量的信息。具体来说有以下几个关键思想：
* 使用专业的单词。例如不用`Get`，根据语境使用`Fetch`或者`Download`可能会更好，这由上下文决定。
* 避免空泛的名字。像`tmp`或者`retval`等名字，除非使用它们有特殊的理由。
* 使用具体的名字来更细致地描述事物。`ServerCanStart()`这个名字比`CanListenPort()`更不清晰。
* 给变量带上重要的细节。例如，在值为毫秒的变量后面缀上`_ms`，或者还需要转义但是目前没有处理的变量前面加上`raw`。
* 为作用域大的名字采用更长的名字。不要用让人费解的一个或者两个字母的名字来命名全局长期可见的变量。对于只存在于几行之间的变量用短一点的名字更好。
* 有目的地使用大小写、下划线等。例如可以在类成员或者局部变量后面加上`_`来区分它们。

### **选择专业的词**
- `get`根据情境，可以用`FetchPage()`或者`DownloadPage()`代替`getPage()`。
- `size()`在树中应该用`height()`表示高度，`numNodes()`表示节点数，用`memoryBytes()`表示内存中所占的空间。

### **找到更有表现力的词**
要使用更适合语境下的更有表现力的词汇，例如以下是一系列的同义词：
| 单词    | 更多选择                                     |
| ----- | ---------------------------------------- |
| send  | deliver、dispatch、 announce、 distribute、route |
| find  | search、extract、locate、recover            |
| start | launch、create、begin、open                 |
| make  | create、set up、build、generate、compose、add、new |

### **避免像泛泛的名字**
- 好的名字应当描述变量的目的或者它承载的值。例如某个函数的返回值为输入数组`x`的算平方和，那么`sum_squares`比`retval`这样的名字要好。因此需要尽量避免使用`tmp`、`retval`、`foo`这样的词。
- 但是某些情况使用空泛的名字也有好处，比如说在交换两个变量的时候使用`tmp`，在循环迭代器中使用`i`、`j`、`iter`，但是在嵌套的循环中，加上有意义的前缀能使之更能相互区分。

### **用具体的名字代替抽象的名字**
- 在给变量、函数或者其他元素命名的时候，要把它们描述的更具体而不是更抽象。例如某个内部方法叫做`ServerCanStart()`，它检测服务是否可以监听某个给定的TCP/IP端口。然而刚刚的名字有点抽象，`CanListenOnPort()`就更加具体一些。

### **为名字附加更多的信息**
- 一个变量就像是一个小小的注释，因此如果关于某个变量如果有什么重要信息，那么值得将额外的“词”添加进名字里。例如如果一个`id`字符串是十六进制的，可以命名为`hex_id`。

- 带单位的值（例如时间长度或者字节数）最好附带上单位：

  | 函数参数                          | 带单位的参数               |
  | :---------------------------- | :------------------- |
  | start(int delay)              | delay --> delay_secs |
  | createCache(int size)         | size --> size_mb     |
  | throttleDownload(float limit) | limit --> max_kbps   |
  | rotate(float angle)           | angle --> degree_cw  |

- 附带额外信息不仅限于单位，对于这个变量存在的危险或者意外的情况下都应该这么做。比如这些属性：

  | 情形                        | 变量名      | 更好的名字              |
  | :------------------------ | -------- | ------------------ |
  | 一个“纯文本”格式的代码，需要加密后才能进一步使用 | password | plaintext_password |
  | 一条用户提供的注释，需要转义之后才能用于显示    | comment  | unescaped_comment  |
  | 已转化为UTF-8格式的html字节        | html     | html_utf8          |
  | 以“url方式编码”的输入数据           | data     | data_urlenc        |

    但是也不是说每个地方都需要这么做。一般来说，如果这是一个需要理解的关键信息，那就应该把信息放入名字里。

- 匈牙利表示法把每个变量的“类型信息”都写进名字的前缀中，例如`pLast`代表一个指向最后一个元素的指针（p），这事实上就是“给变量名字附带上属性的特例”：
  | 名字                          | 含义            |
  | :---------------------------- | :------------------- |
  | pLast              | 指向某数据结构的最后一个元素的指针（p） |
  | pszBuffer         | 指向一个以零结尾（z）的字符串（s）的指针（p）     |
  | cch | 一个字符（ch）的计数（c）  |
  | mpcopx           | 在指向颜色的指针（pco）和指向x轴的长度的指针（px）之间的一个映射（m）  |

## 名字的长度
- 在小作用域中使用短的名字，相反在大作用域中使用长名字。

- 现代编辑器能方便你键入长名字，例如很多IDE可以使用tab键进行变量名补全。

- 在一般性实践中，采用首字母缩略词或者缩写是糟糕的实践（例如命名类为`BEManager`而不是`BackEndManager`）。经验原则是：团队的新成员能否理解这个名字的含义？如果可以的话，首字母缩写没有太大问题。首字母缩略词和单词缩写应该是大家普遍接受和理解的，例如用doc代替document、str代替string。

- 丢掉没用的词，`ConvertToString`可以直接写成`toString`，这样也没有丢失任何信息。

- 利用名字的格式来传递含义，java中，例如

  | 情形     | 规则               |
  | :----- | ---------------- |
  | 类名     | 大驼峰命名法           |
  | 方法、变量名 | 小驼峰命名法           |
  | 常量名    | 全部大写字母，不同单词下划线分割 |

- 不论代码中采用何种规范，团队或者项目要保持一致

## 3. 不会让人误解的名字
===================================================

### **本节关键思想**
不让人产生误解的名字就是好名字。阅读你代码的人应该理解你的本意，并且不会产生歧义。遗憾的是很多英文单词本身就是多义的，例如`filter`或者`length`。具体来说要关注以下几个点：
* 使用某一个名字之前，要吹毛求疵一点，想象一下你的名字会被误解成什么。最好的名字是不会存在误解。
* 当定义值的上下限时，`min/max`是很好的前缀；当对于包含的范围时，`first/last`是很好的选择；当对于包含/排除范围时，`begin/end`是很好的选择。
* 当为布尔值命名是，使用`is`和`has`这样的词来明确表明它是个布尔值，并且需要避免使用反义的词（例如`disable_ssl`）
* 小心用户对于特定词的刻板印象。例如用户会期待`get()`或者`size()`是不怎么消耗计算机资源的轻量级方法。

### **名字不应让人误解**
例如，在写一段数据库操作的代码的时候，采用如下的代码：
```Python
results = Database.all_objects.filter("year <= 2011")
```
这里的问题是，`filter`是个二义性的单词。我们此处不清楚这个词在这里到底是“挑出”还是“除去”。因此此处最好避免采用`filter`这个词。


### **使用min或者max来表示（包含）极限**
例如你的购物车应用程序最多不能超过10个物品：
```Python
CART_TOO_BIG_LIMIT = 10

if shopping_cart.num_items() >= CART_TOO_BIG_LIMIT:
    Error("Too many items in cart.")
```
该段代码问题的根源在于：`CART_TOO_BIG_LIMIT`变量是一个二义性名字，它的含义到底是“少于”还是“少于/且包括”。因此可以改成：
```Python
MAX_ITEMS_IN_CART = 10

if shopping_cart.num_items() > MAX_ITEMS_IN_CART:
    Error("Too many items in cart.")
```

### **推荐用first和last来表示包含的范围**
例如下面的例子没法判断它是“少于”还是“少于且包含”：
```Python
# 这个语句是打印[2, 3]呢，还是打印[2, 3, 4]？
print(integer_range(start=2, end=4))
```
尽管上面的`start`是一个合理的参数名，但是`stop`可以有多重解读。因此，一个好的选择是使用`first`和`last`，例如：
```Java
set.PrintKeys(first="Bart", last="Maggie")
```

### **推荐用begin和end来表示包含/排除范围**
在实践中，针对包含/排除范围更方便的是使用`begin/end`这样的关键字，如同上一个例子所示。

### **给布尔值命名**
当给布尔变量或者具有布尔返回值的函数选择名字的时候，要确保返回`True`和`False`的意义很明确。

例如这就是一个危险的例子：
```C++
bool read_password = true;
```
上面这段代码会有两种截然不同的解释：
- 我们需要读取密码。
- 我们已经读取了密码。
在本例中，最好避免使用`read`，用`need_password`或者`user_is_authenticated`这样的名字更加合适。通常来说加上`is`、`has`、 `can`或者`should`这样的词，会使得布尔值更加明确。例如`SpaceLeft()`函数听上去会返回一个数字，但是如果它本意是返回布尔值，那么`HasSpaceLeft()`这个名字会更好一些。

最后，最好避免使用反义名字！例如不要使用：
```C++
bool disable_ssl = false;
```
而应该改写为：
```C++
bool use_ssl = true;
```

### **与使用者的期望相匹配**
有些名字之所以让人产生误解是因为用户对它们的含义产生了先入为主的印象，就算你的本意并非如此。在这种情况下，最好放弃这个名字而改用一个不会让人误解的名字。

## 4. 审美
===================================================

### **三条基本原则**
好的源代码应当看上去“养眼”。确切的说，美的代码有以下三条原则：
- 使用一致的布局，让读者很快就习惯这种风格。
- 让相似的代码看上去相似。
- 把相关的代码行分组，形成代码块。

### **总体技巧**
- 如果多个代码块做相似的事情，尝试让它们具有相似的结构特性。
- 把代码按照“列”对齐，可以让代码更容易阅读。
- 如果一段代码提到了A、B和C，那么不要在另一段代码中说B、C和A。选择一个有意义的顺序，并且始终用这样的顺序。
- 把代码分成有逻辑的**段落**：把相似的想法放在一起并与其他想法分开。
- **一致的**风格比正确的风格更重要

## 5. 注释
===================================================

关键思想：注释的目的是尽量帮助读者了解得和作者一样多。

### **什么不需要注释**
- 不要为了那些从代码本身就能**快速**推断的事实写注释。
- 不要为了注释而注释，没有提供比代码本身更多信息的注释要么删除，要么改进。
- 不要给不好的名字加注释---**应该把名字改好**，**好代码 > 坏代码 + 好注释**。

### **什么需要注释**
- 记录你写代码时重要的想法。
- 记录对代码有价值的见解，例如：解释代码没法修复的缺陷、代码不整洁的原因。
- 为代码中的瑕疵写注释，比如有如下几种标记：
    | 标记     | 通畅的意义                |
    | ------ | -------------------- |
    | TODO:  | 我还没有处理的事情            |
    | FIXME: | 已知的无法运行的代码           |
    | HACK:  | 对一个问题不得不采用的比较粗糙的解决方案 |
    | XXX:   | 危险！这里有重要的问题          |

- 给常量加注释，记下决定这个常量值时的想法。
- 站在读者的角度：
  - 考虑读者阅读这段代码时可能出现提问，并将提问的答案写在注释中
  - 公布可能的陷阱
  - 编写文件级别的注释，让读者熟悉代码库
  - 在一个类或者函数内部编写总结性的注释
- 克服“作者心理阻滞”：
  - 不管心里想什么，先把它写下来
  - 读一下这段注释，看看有没有什么可以改进的地方
  - 不断改进
  当你经常写注释，你会发现步骤1所产生的注释会越来越好，就越不需要后面两步了

## 写出言简意赅的注释
- 让注释保持紧凑。
- 避免使用不明确的代词。
- 润色粗糙的句子。
- 精确的描述函数的行为。
- 对于输入输出，精心挑选一个例子就够了。
- 声明代码的意图。
- “具名”函数的参数，就是用注释标明函数参数的含义，用来解释难以理解的函数参数。
- 采用信息含量高的词。